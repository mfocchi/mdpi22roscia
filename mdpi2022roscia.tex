%  LaTeX support: latex@mdpi.com 
%  For support, please attach all files needed for compiling as well as the log file, and specify your operating system, LaTeX version, and LaTeX editor.

%=================================================================
\documentclass[sensors,article,submit,pdftex,moreauthors]{Definitions/mdpi} 
% For posting an early version of this manuscript as a preprint, you may use "preprints" as the journal and change "submit" to "accept". The document class line would be, e.g., \documentclass[preprints,article,accept,moreauthors,pdftex]{mdpi}. This is especially recommended for submission to arXiv, where line numbers should be removed before posting. For preprints.org, the editorial staff will make this change immediately prior to posting.

%--------------------
% Class Options:
%--------------------
%----------
% journal
%----------
% Choose between the following MDPI journals:
% acoustics, actuators, addictions, admsci, adolescents, aerospace, agriculture, agriengineering, agronomy, ai, algorithms, allergies, alloys, analytica, animals, antibiotics, antibodies, antioxidants, applbiosci, appliedchem, appliedmath, applmech, applmicrobiol, applnano, applsci, aquacj, architecture, arts, asc, asi, astronomy, atmosphere, atoms, audiolres, automation, axioms, bacteria, batteries, bdcc, behavsci, beverages, biochem, bioengineering, biologics, biology, biomass, biomechanics, biomed, biomedicines, biomedinformatics, biomimetics, biomolecules, biophysica, biosensors, biotech, birds, bloods, blsf, brainsci, breath, buildings, businesses, cancers, carbon, cardiogenetics, catalysts, cells, ceramics, challenges, chemengineering, chemistry, chemosensors, chemproc, children, chips, cimb, civileng, cleantechnol, climate, clinpract, clockssleep, cmd, coasts, coatings, colloids, colorants, commodities, compounds, computation, computers, condensedmatter, conservation, constrmater, cosmetics, covid, crops, cryptography, crystals, csmf, ctn, curroncol, currophthalmol, cyber, dairy, data, dentistry, dermato, dermatopathology, designs, diabetology, diagnostics, dietetics, digital, disabilities, diseases, diversity, dna, drones, dynamics, earth, ebj, ecologies, econometrics, economies, education, ejihpe, electricity, electrochem, electronicmat, electronics, encyclopedia, endocrines, energies, eng, engproc, ent, entomology, entropy, environments, environsciproc, epidemiologia, epigenomes, est, fermentation, fibers, fintech, fire, fishes, fluids, foods, forecasting, forensicsci, forests, foundations, fractalfract, fuels, futureinternet, futureparasites, futurepharmacol, futurephys, futuretransp, galaxies, games, gases, gastroent, gastrointestdisord, gels, genealogy, genes, geographies, geohazards, geomatics, geosciences, geotechnics, geriatrics, hazardousmatters, healthcare, hearts, hemato, heritage, highthroughput, histories, horticulturae, humanities, humans, hydrobiology, hydrogen, hydrology, hygiene, idr, ijerph, ijfs, ijgi, ijms, ijns, ijtm, ijtpp, immuno, informatics, information, infrastructures, inorganics, insects, instruments, inventions, iot, j, jal, jcdd, jcm, jcp, jcs, jdb, jeta, jfb, jfmk, jimaging, jintelligence, jlpea, jmmp, jmp, jmse, jne, jnt, jof, joitmc, jor, journalmedia, jox, jpm, jrfm, jsan, jtaer, jzbg, kidney, kidneydial, knowledge, land, languages, laws, life, liquids, literature, livers, logics, logistics, lubricants, lymphatics, machines, macromol, magnetism, magnetochemistry, make, marinedrugs, materials, materproc, mathematics, mca, measurements, medicina, medicines, medsci, membranes, merits, metabolites, metals, meteorology, methane, metrology, micro, microarrays, microbiolres, micromachines, microorganisms, microplastics, minerals, mining, modelling, molbank, molecules, mps, msf, mti, muscles, nanoenergyadv, nanomanufacturing, nanomaterials, ncrna, network, neuroglia, neurolint, neurosci, nitrogen, notspecified, nri, nursrep, nutraceuticals, nutrients, obesities, oceans, ohbm, onco, oncopathology, optics, oral, organics, organoids, osteology, oxygen, parasites, parasitologia, particles, pathogens, pathophysiology, pediatrrep, pharmaceuticals, pharmaceutics, pharmacoepidemiology, pharmacy, philosophies, photochem, photonics, phycology, physchem, physics, physiologia, plants, plasma, pollutants, polymers, polysaccharides, poultry, powders, preprints, proceedings, processes, prosthesis, proteomes, psf, psych, psychiatryint, psychoactives, publications, quantumrep, quaternary, qubs, radiation, reactions, recycling, regeneration, religions, remotesensing, reports, reprodmed, resources, rheumato, risks, robotics, ruminants, safety, sci, scipharm, seeds, sensors, separations, sexes, signals, sinusitis, skins, smartcities, sna, societies, socsci, software, soilsystems, solar, solids, sports, standards, stats, stresses, surfaces, surgeries, suschem, sustainability, symmetry, synbio, systems, taxonomy, technologies, telecom, test, textiles, thalassrep, thermo, tomography, tourismhosp, toxics, toxins, transplantology, transportation, traumacare, traumas, tropicalmed, universe, urbansci, uro, vaccines, vehicles, venereology, vetsci, vibration, viruses, vision, waste, water, wem, wevj, wind, women, world, youth, zoonoticdis 

%---------
% article
%---------
% The default type of manuscript is "article", but can be replaced by: 
% abstract, addendum, article, book, bookreview, briefreport, casereport, comment, commentary, communication, conferenceproceedings, correction, conferencereport, entry, expressionofconcern, extendedabstract, datadescriptor, editorial, essay, erratum, hypothesis, interestingimage, obituary, opinion, projectreport, reply, retraction, review, perspective, protocol, shortnote, studyprotocol, systematicreview, supfile, technicalnote, viewpoint, guidelines, registeredreport, tutorial
% supfile = supplementary materials

%----------
% submit
%----------
% The class option "submit" will be changed to "accept" by the Editorial Office when the paper is accepted. This will only make changes to the frontpage (e.g., the logo of the journal will get visible), the headings, and the copyright information. Also, line numbering will be removed. Journal info and pagination for accepted papers will also be assigned by the Editorial Office.

%------------------
% moreauthors
%------------------
% If there is only one author the class option oneauthor should be used. Otherwise use the class option moreauthors.

%---------
% pdftex
%---------
% The option pdftex is for use with pdfLaTeX. If eps figures are used, remove the option pdftex and use LaTeX and dvi2pdf.

%=================================================================
% MDPI internal commands
\firstpage{1} 
\makeatletter 
\setcounter{page}{\@firstpage} 
\makeatother
\pubvolume{1}
\issuenum{1}
\articlenumber{0}
\pubyear{2022}
\copyrightyear{2022}
%\externaleditor{Academic Editor: Firstname Lastname}
\datereceived{} 
%\daterevised{} % Only for the journal Acoustics
\dateaccepted{} 
\datepublished{} 
%\datecorrected{} % Corrected papers include a "Corrected: XXX" date in the original paper.
%\dateretracted{} % Corrected papers include a "Retracted: XXX" date in the original paper.
\hreflink{https://doi.org/} % If needed use \linebreak
%\doinum{}
%------------------------------------------------------------------
% The following line should be uncommented if the LaTeX file is uploaded to arXiv.org
%\pdfoutput=1

%=================================================================
% Add packages and commands here. The following packages are loaded in our class file: fontenc, inputenc, calc, indentfirst, fancyhdr, graphicx, epstopdf, lastpage, ifthen, lineno, float, amsmath, setspace, enumitem, mathpazo, booktabs, titlesec, etoolbox, tabto, xcolor, soul, multirow, microtype, tikz, totcount, changepage, attrib, upgreek, cleveref, amsthm, hyphenat, natbib, hyperref, footmisc, url, geometry, newfloat, caption
\usepackage{glossaries}
\usepackage{bm}
\usepackage{tensor}
%\input{includes/used_packages.tex}
\input{includes/acronyms.tex}
%\input{includes/math_commands.tex}
%\input{includes/newcommands.tex}

\newcommand{\MF}[1]{\textcolor{red}{#1}}
%\newcommand{\MF}[1]{\textcolor{black}{#1}}
\newcommand{\CS}[1]{\textcolor{violet}{\textbf{csemini}: #1}}
\newcommand{\FR}[1]{\textcolor{teal}{\textbf{froscia}: #1}}
\newcommand{\ADP}[1]{\textcolor{blue}{\textbf{adelprete}: #1}}
%=================================================================
%% Please use the following mathematics environments: Theorem, Lemma, Corollary, Proposition, Characterization, Property, Problem, Example, ExamplesandDefinitions, Hypothesis, Remark, Definition, Notation, Assumption
%% For proofs, please use the proof environment (the amsthm package is loaded by the MDPI class).

%=================================================================
% Full title of the paper (Capitalized)
\Title{Orientation Control System: Enhancing Aerial Maneuvers for Quadruped Robots}

% MDPI internal command: Title for citation in the left column
\TitleCitation{Orientation Control System: Enhancing Aerial Maneuvers for Quadruped Robots}

% Author Orchid ID: enter ID or remove command
%\newcommand{\orcidauthorA}{0000-0000-0000-000X} % Add \orcidA{} behind the author's name
%\newcommand{\orcidauthorB}{0000-0000-0000-000X} % Add \orcidB{} behind the author's name

% Authors, for the paper (add full first names)
\Author{Francesco Roscia $^{1}$, Andrea Cumerlotti $^{1, \, 2}$, Andrea Del Prete $^{2}$, Claudio Semini $^{1}$ and Michele Focchi$^{1, \, 3, ^*}$}

%\longauthorlist{yes}

% MDPI internal command: Authors, for metadata in PDF
\AuthorNames{Francesco Roscia, Andrea Cumerlotti, Andrea Del Prete, Claudio Semini and Michele Focchi}

% MDPI internal command: Authors, for citation in the left column
\AuthorCitation{Roscia, F.; Cumerlotti, A.; Del Prete, A., Semini, C.; Focchi, M.}
% If this is a Chicago style journal: Lastname, Firstname, Firstname Lastname, and Firstname Lastname.

% Affiliations / Addresses (Add [1] after \address if there is only one affiliation.)
\address{%
$^{1}$ \quad Dynamic Legged Systems (DLS) lab, Istituto Italiano di Tecnologia (IIT), Genoa, Italy\\
$^{2}$ \quad Industrial Engineering Department (DII), University of Trento, Trento, Italy\\
$^{3}$ \quad Department of Information Engineering and Computer Science (DISI), University of Trento, Trento, Italy\\
}

% Contact information of the corresponding author
\corres{Correspondence: michele.focchi@unitn.it}

% Current address and/or shared authorship
%\firstnote{Current address: Affiliation 3.} 
%\secondnote{These authors contributed equally to this work.}
% The commands \thirdnote{} till \eighthnote{} are available for further notes

%\simplesumm{} % Simple summary

%\conference{} % An extended version of a conference paper

% Abstract (Do not insert blank lines, i.e. \\) 
\abstract{For legged robots, aerial motions are the only option to overpass obstacles that cannot be circumvent with standard locomotion gaits. In these cases, the robot must perform a leap to either jump onto the obstacle or fly over it. However, these movements represent a challenge because during the flight phase the \gls{com} cannot be controlled, and the robot orientation has limited controllability. This paper focuses on the latter issue and proposes an \gls{ocs} consisting of two rotating and actuated masses (flywheels or reaction wheels) to gain control authority on the robot orientation. Because of the conservation of angular momentum, their rotational velocity can be adjusted to steer the robot orientation even when there are no contacts with the ground. The axes of rotation of the flywheels are designed to be incident, leading to a compact orientation control system that is capable of controlling both roll and pitch angles, considering the different moment of inertia in the two directions. \MF{The concept is tested with simulations on the robot Solo12.}}

\makeglossaries
% Keywords
\keyword{Legged robot, Orientation Control, Articulated Multi-body System} 

% The fields PACS, MSC, and JEL may be left empty or commented out if not applicable
%\PACS{J0101}
%\MSC{}
%\JEL{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Only for the journal Diversity
%\LSID{\url{http://}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Only for the journal Applied Sciences
%\featuredapplication{Authors are encouraged to provide a concise description of the specific application or a potential application of the work. This section is not mandatory.}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Only for the journal Data
%\dataset{DOI number or link to the deposited data set if the data set is published separately. If the data set shall be published as a supplement to this paper, this field will be filled by the journal editors. In this case, please submit the data set as a supplement.}
%\datasetlicense{License under which the data set is made available (CC0, CC-BY, CC-BY-SA, CC-BY-NC, etc.)}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Only for the journal Toxins
%\keycontribution{The breakthroughs or highlights of the manuscript. Authors can write one or two sentences to describe the most important part of the paper.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Only for the journal Encyclopedia
%\encyclopediadef{For entry manuscripts only: please provide a brief overview of the entry title instead of an abstract.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Only for the journal Advances in Respiratory Medicine
%\addhighlights{yes}
%\renewcommand{\addhighlights}{%

%\noindent This is an obligatory section in “Advances in Respiratory Medicine”, whose goal is to increase the discoverability and readability of the article via search engines and other scholars. Highlights should not be a copy of the abstract, but a simple text allowing the reader to quickly and simplified find out what the article is about and what can be cited from it. Each of these parts should be devoted up to 2~bullet points.\vspace{3pt}\\
%\textbf{What are the main findings?}
% \begin{itemize}[labelsep=2.5mm,topsep=-3pt]
% \item First bullet.
% \item Second bullet.
% \end{itemize}\vspace{3pt}
%\textbf{What is the implication of the main finding?}
% \begin{itemize}[labelsep=2.5mm,topsep=-3pt]
% \item First bullet.
% \item Second bullet.
% \end{itemize}
%}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}\label{sec:introduction}
Legged robots are designed for traversing rough terrain.
Different types of gaits, such as trot \MF{\cite{barasuol2013reactive}} or crawl \MF{\cite{focchi2020heuristic}}, have been developed for quadrupedal robots. 
Thanks to the progress of the last two decades, robots have become lighter and stronger, which has enabled them to perform agile locomotion.
However, sometimes it is not possible to get around or over an obstacle with the gaits mentioned above, and jumps are required. 

When the robot is in the air, the \gls{com} moves on the ballistic trajectory, that is completely defined by the lift-off position and velocity. On the other hand, the base orientation can be changed exploiting the conservation of the system angular momentum. This means that it is possible to control the base angular velocity by changing the inertia of the robot, e.g., changing the joints configuration. Nevertheless, the majority of quadrupeds are designed with light legs, resulting in limbs that have small influence on the total angular momentum.

Quadrupedal animals, like cats, can rearrange tail and trunk to correct the orientation during a fall \cite{kane1969dynamical}.
% Tail
Many works in the field of robotics used an additional link as a tail, like in \cite{chu2019null} and \cite{wenger2016frontal}.
This link rotates around an axis that does not pass through the robot \gls{com}: the distances between the axis of rotation and the \gls{com} of both trunk and tail result in a large effect on the total inertia even with a small tail mass.
However, the placement of the additional link makes the resulting robot asymmetric. Moreover, due to its limited range of motion, a tail can be used only for a single jump, not for a repeated sequence \cite{johnson2012tail}.
\MF{To circumvent these drawbacks, in \cite{an2022design}, \cite{an2020development}, \cite{tang2022towards} the authors attach a morphable inertial tail with 3-\gls{dofs} (pitch, yaw, and telescoping) on a monopod, a biped and a quadruped, respectively, to enhance more agile locomotion and improve safe landing.}
\\
% Legs reconfig
It is possible to obtain a similar result by creating repetitive circular motions with the feet, like in \cite{hoffman2021exploiting}. \MF{Moving the feet outwards increases the robot total inertia, so if a leg is extended during half of the motion and retracted in the other half, a net angular momentum will result on the trunk, causing a rotation. In \cite{kurtz2022mini}} the authors proposed special heavy boots for Mini Cheetah and used a neural network to calculate online joint trajectories. However, this solution unnecessarily increases the inertia of the legs, complicating the locomotion problem, which can no longer rely on the massless leg assumption. \\ 
% Gyros
Another option is to use a \gls{cmg}.
It consists of a wheel, spinning at a constant angular velocity inside two or three actuated gimbals.
Tilting the wheel's axis of rotation generates the gyroscopic torque.
This system is widespread in spacecrafts reorientation \cite{yoon2002spacecraft}, but less frequently exploited in robot locomotion, either wheeled \cite{brown1996single} or legged \cite{mikhalkov2021gyrubot}.
The \gls{cmg} presents interesting capabilities, but the presence of a pan-tilt unit to drive the gyroscope makes it impractical to mount it on a small, lightweight robot.\\
% flywheel
Flywheels represent an additional option for controlling the robot orientation.
Changing the angular velocity of a rotating mass attached to the trunk generates a torque that can reorient the robot. This device has been first applied for spacecraft orientation \cite{oland2009reaction}, and later it has been only sporadically investigated in legged locomotion for controlling pitch orientation, both for bipeds \cite{Brown2016}, \cite{xiong2020sequential} and quadrupeds \cite{kolvenbach2019towards}, \cite{vasilopoulos2016quadruped}.
Compared with tails, flywheels do not have position limits, and since their rotation axes pass through the \gls{com}, its angular momentum results holonomic \cite{machairas2015quadruped}.
To get a fast response, it is necessary to have an abrupt change in the flywheels angular velocity (angular acceleration).
Using a brake avoids the employment of a motor able to deliver higher torques \cite{gajamohan2012cubli}, 
keeping the system compact: the motor slowly accelerates the wheel to a certain speed to store angular momentum and, when a reorientation is required, the break stops its spin.
Since the effect of the break is unidirectional, a limitation of this approach is given by the fact that it is possible to generate a rotation of the base only in the opposite direction of the flywheel angular velocity making them unsuitable for applications where \textit{continuous} controllability is required. On the other hand, direct-drive controlled flywheels enable to create accelerations in both directions,  and  to implement continuous control laws. \\
The benefits of this kind of \gls{ocs} are multiple. 
\begin{enumerate}
\item Flywheels can correct orientation errors during the flight (e.g. due to disturbances or tracking inaccuracies in the angular momentum achieved at the lift-off)   % and non-idealities).  
in a continuous manner. 
\item They enable to track a time-varying reference, e.g. to have the robot land with a desired angular velocity (possibly zero) and orientation.
\item  Even in presence of contacts, they can enhance the landing phase or stabilize dynamic gaits (e.g. trot), by significantly reducing trunk oscillations.  
\item  The presence of these additional joints, whose only function is to control the orientation, gives the possibility to relieve the effort of the legs.
\end{enumerate}
In more complex scenarios, like for a somersault, limbs and \gls{ocs} can operate in parallel to achieve a rotation angle larger than the one achievable only with legs (e.g., due to torque limitation). 


\subsection{Proposed Approach and Contribution}
\begin{figure}[t!]
	\centering
	\includegraphics[width=7cm,height=8cm,keepaspectratio]{figures/solo_fw_pic_compressed.png}
	\caption{\small The proposed Orientation Control System for 
		for the $2.5 \ \mathrm{kg}$ quadruped robot Solo12 consists of two $0.1 \ \mathrm{kg}$ flywheels with incident rotation axes. Each wheel is located in a 3D-printed shell and mounted on the trunk body.}
	\label{fig:solo12flywheels}
\end{figure} 
\MF{This work introduces} a compact \gls{ocs} based on two flywheels, mounted on the trunk of the lightweight quadruped Solo12 \cite{grimminger2020open}. \MF{The open-source hardware and software are reported in \cite{github_solo}. Fig. \ref{fig:solo12flywheels} shows the \gls{ocs} mounted on the trunk of the robot. }
The contributions of the paper are:
\begin{itemize}
	\item the design of a novel \gls{ocs} that enables to control the orientation of a legged robot during a jump in an effective way, while keeping the design simple. 
	In particular, the axes of rotation of the flywheels are set to be incident, enabling \textit{continuous} controllability in both the directions (roll and pitch) while keeping the device compact.
	\item simulations  with the quadruped Solo12 that demonstrate the effectiveness of the proposed approach.
\end{itemize}



\subsection{Outline}
The remainder of this paper is organized as follow. In Section \ref{sec:background}, the law of conservation of the total angular momentum is recalled. In Section \ref{sec:ocs}, the design principles are presented together with the strategy for simultaneously control the robot roll and pitch orientations. Section \ref{sec:simulations} presents simulation in different scenarios that demonstrate the the capability of our \gls{ocs} to reject disturbances and to track angular references when there is no contact with the ground, and damping of base oscillation after the touch-down. Conclusions and a possible evolution of the work ar reported in Section \ref{sec:conclusions}.


\section{Background}
\label{sec:background}
The starting point for any \gls{ocs} is the Euler's equation. For any mechanical system, the time derivative of the angular momentum $\bm{L}$ computed with the respect to a reference point $O$, fixed in an inertial frame, equals the sum of the moments $\bm{M}_i$ applied to the system with respect to the same reference point:
\begin{equation}
\dot{\bm{L}} = \sum_i \bm{M}_i
\end{equation}
When the resultant of the external moments applied to the system is zero, the Euler's equation simplifies to:
\begin{equation}
\dot{\bm{L}} = 0 \quad \Rightarrow \quad \bm{L}(t) = const,
\label{eq:cons_ang_mom}
\end{equation}
which is known as conservation of angular momentum.
Referring to legged robots, this condition occurs when the system is not in contact with the ground or other objects, e.g., during a fall or the flight phase of a jump.
In this case, it is possible to change the angular velocity of the base link changing the joint positions and velocities, as a result of the \textit{non-holonomy} of the total angular momentum \cite{wieber2016modeling}: if the angular momentum of a certain body changes, the one of the others must change to maintain the total sum constant.
\subsection{Preliminary Analysis}
Most of quadruped robots are designed in such a way that the largest amount of the mass is located at the main body. As a consequence, the contribution of the moments due to the acceleration of other bodies (i.e. leg links) is moderate. \\
As an example, let consider the case of Solo12. Even if each limb accounts for about $13.4\%$ of the total mass, changes of the total robot inertia come with the motion of only the upperleg (thigh) and the lowerleg (calf), since the displacement of distribution of the hip mass with the system \acrshort{com} is approximately constant. \MF{In view of this, each limb is responsible for only $7.5\%$ of the total mass to vary the total inertia of the robot}. Flywheels can be used for alleviating the lack of control authority.


\section{Orientation Control System}
\label{sec:ocs}
In this section, a procedure to select the inertia of the flywheels \MF{is presented, together with a strategy} to exploit them for simultaneously controlling the robot roll and pitch orientation.


\subsection{Bounds on the Inertia}
Investigation for the selection of the flywheels' inertia can be performed with the Elroy's Beanie model, depicted in Fig. \ref{fig:elroy-beanie}.
\begin{figure}[t!]
	\centering
	\includegraphics[width=.7\linewidth]{figures/elroys-beanie.eps}
	\caption{\small Schematic representation of the Elroy's Beanie model used for the preliminary analysis of the pitch motion.}
	\label{fig:elroy-beanie}
\end{figure} 
\begin{figure}[t]
	\centering
	\includegraphics[width=.8\linewidth]{figures/lowerbound2.eps}
	\caption{\small Minimum inertia of the \gls{ocs} (normalized by the robot inertia) necessary to achieve a base velocity variation $\Delta \dot{\theta}$, given the actuation bound $\dot \gamma^{max}$.}
	\label{fig:inertia_limits}
\end{figure}
This consists of two rigid bodies connected through their \gls{com} with a revolute joint. One of the bodies represents the robot in its nominal configuration. The other models the \gls{ocs}, here represented by a single wheel for the sake of simplicity. The aim is to examine the rotational dynamics of the system as a whole. To simplify the analysis, in the following \MF{only the effects on the pitch angle of the robot is considered}, keeping in mind that the same arguments apply also to the roll. 
Let us identify the moment of inertia of the robot in the nominal configuration as $I_r$ and the moment of inertia of the two flywheels as $I_f$, both referred to the system \gls{com}.
The angular momentum $L$ of this system can be written as
\begin{equation}\label{eq:ang_mom_elroy}
L(t) = \left(I_r + I_{f}\right)\dot{\theta}(t) + I_{f}\dot{\gamma}(t)
\end{equation}
where $\dot{\theta}$ and $\dot{\gamma}$ are respectively the robot pitch rate and the angular speed of the wheel.
\MF{The robot is driven to reach} a desired pitch rate $\dot{\theta}_{des}$ by acting on the wheel speed.
Without loss of generality, \MF{one} can assume the flywheel is stationary with the robot at the instant at which the reorientation maneuver starts ($\dot{\gamma}_0 = 0$), having a system angular momentum of $L_0 = \left(I_r + I_{f}\right)\dot{\theta}_0$.
Under the condition of conservation of the angular momentum, this quantity is constant over time and it is possible to estimate the lower bound for $I_{f}$ given a desired pitch rate and the maximum velocity of the flywheels $\dot{\gamma}_{max}$:
\begin{equation}
I_{f} \geq I_r \dfrac{ \Delta \dot{\theta} }{\Delta \dot{\theta}+\dot{\gamma}_{max}}.
\end{equation}
where $\Delta \dot{\theta} =  \left\lvert \dot{\theta}_0-\dot{\theta}_{des} \right\rvert$ is the base velocity variation.
Fig. \ref{fig:inertia_limits} reports the lower bound of $I_{f}$ given the desired base velocity variation and the maximum velocity of the actuator.



\subsection{Flywheels Axes of Rotation}
\label{subseq:flywheel_axes}
\begin{figure}[t]
	\centering
	\includegraphics[width=7cm,height=8cm,keepaspectratio]{figures/axes.eps}
	\caption{\small \MF{Top view of Solo12 with the proposed \gls{ocs}. The $x-$ and $y-$axes embody the forward and left directions of the robot base, respectively. The picture reports also the unit vectors $\hat{\bm{a}}_l$ and $\hat{\bm{a}}_r$  that represent the axes of rotation of the left flywheel and of the right one: $\alpha$ is the angle of incidence defined in \ref{subseq:flywheel_axes}.}}
	\label{fig:axes}
\end{figure}
The orientation of the axis of rotation of each flywheel influences their contribution to the total angular momentum. To meet the specification of controlling both the robot roll and pitch, the axes of rotation of the left and right wheel, identified in the base reference frame with the unit vectors $\hat{\bm{a}}_l$ and $\hat{\bm{a}}_r$, are set to be incident, laying on a plane parallel to the $xy-$plane of the base reference frame (see Fig. \ref{fig:axes}). 
To remove unnecessary complications, \MF{the authors} designed two identical modules, to be mounted on the trunk of Solo12, symmetrically with the respect of the robot sagittal plane. \MF{Let} denote with $\alpha \leq \pi/2$ the non-negative incident angle between the wheels' axes of rotation and the robot lateral direction. The matrix 
\begin{equation}
\bm{C} = 
\left[ \begin{array}{cc}
\hat{\bm{a}}_l & \hat{\bm{a}}_r
\end{array} \right] = 
\left[ \begin{array}{cc}
\sin(\alpha) & -\sin(\alpha) \\
\cos(\alpha) & \cos(\alpha) \\
0 & 0
\end{array} \right]
\end{equation}
maps the flywheel moments into scalar torques $\bm{u} = \left[\begin{array}{cc} \tau_{fl} & \tau_{fr} \end{array} \right]^T$ about the flywheel axes $\hat{\bm{a}}_l$ and $\hat{\bm{a}}_r$ (expressed in the base frame).
As long as $\bm{C}$ is full column rank, it is possible to control both roll and pitch angles. If $\alpha = 0$, the roll results to be uncontrollable through the \gls{ocs}; otherwise, if $\alpha = \pi/2$, the pitch is uncontrollable. 
The angle is selected considering the ratio of the eigenvalues along the $x$ and $y$ directions of the ellipsoid of the robot inertia(Fig. \ref{fig:ellipsoid}):
\MF{\begin{equation}
\alpha^{*}=\tan^{-1}\left(\dfrac{I_{r, xx}}{I_{r, yy}}\right).
\end{equation}}
\begin{figure}[t]
	\centering
	\includegraphics[width=1\linewidth]{figures/inertiaEllipsoid.eps}
	\caption{\small The inertia tensor can be seen as an ellipsoid. Its principal axes in the direction of the eigenvectors of the tensor and their length depends on the eigenvalues.}
	\label{fig:ellipsoid}
\end{figure}
In the case of Solo12, this angle is about $40^{\circ}$. With these considerations, the angular momentum produced by the wheels, expressed in the robot base frame, is:
\begin{equation}
\begin{split}
\tensor[_b]{\bm{L}}{_f} &= \tensor[_b]{\bm{L}}{_{fl}} + \tensor[_b]{\bm{L}}{_{fr}} \\
&=I_{f, zz} \, \bm{\omega}_{fl} + I_{f, zz} \, \bm{\omega}_{fr}\\
&=I_{f, zz}
\left[\begin{array}{c}
\left(\omega_{fl} - \omega_{fr}\right)\sin(\alpha) \\ 
\left(\omega_{fl} +  \omega_{fr}\right)\cos(\alpha) \\
0
\end{array}\right]
\end{split}
\label{eq:bLf}
\end{equation}
in which $\bm{\omega}_{fl}= \omega_{fl} \, \hat{\bm{a}}_{l}$ and $\bm{\omega}_{fr}= \omega_{fr} \, \hat{\bm{a}}_{r}$ are the angular velocity vectors of the two wheels, and $\omega_{fl}$ and $\omega_{fr}$ are the angular speeds provided to each flywheel by its actuation system. The latter equation shows that the difference of the two angular speeds impacts on roll rotations, while their difference can be used to adjust the pitch, see Fig. \ref{fig:sum-diff}. Using the definition of $\bm{C}$, \eqref{eq:bLf} rewrites as
\begin{equation}
\begin{split}
\tensor[_b]{\bm{L}}{_f} & = I_{f,zz}
\left[
\begin{array}{cc}
\sin(\alpha) & -\sin(\alpha) \\
\cos(\alpha) & \cos(\alpha) \\
0 & 0
\end{array}
\right]
\left[
\begin{array}{cc}
\omega_{fl} \\
\omega_{fr}
\end{array}
\right] \\
&= I_{f,zz} \bm{C} \bm{\omega}_f.
\end{split}
\end{equation}
\begin{figure}
	\centering
	\includegraphics[width=.7\linewidth]{figures/sum_diff_mod.eps}
	\caption{\small Having incident rotation axes, the \gls{ocs} allows to control both the robot roll and pitch. Notice that the roll angle is influenced by the difference of the angular speeds of the flywheels, $\omega_x = \left(\omega_{fl} - \omega_{fr}\right)\sin(\alpha)$. On the contrary, the pitch angle depends on the sum of the angular speeds $\omega_y = \left(\omega_{fl} +  \omega_{fr}\right)\cos(\alpha)$.}
	\label{fig:sum-diff}
\end{figure}

\subsection{Inertia Selection}
Once the desired inertia $I_f$ is chosen, according to the 2D Elroy's Beanie model, it is used to realize the 3D \gls{ocs} (Fig. \ref{fig:flywheel}). 
\MF{Two identical flywheels are designed to have} the shape of hollow cylinders. This shape increases the inertia by locating the mass far away from the rotation axis. The inertia tensor expressed in its principal axes, $\bm{I}_f = \mathrm{diag}\left\{ I_{f, xx}, \, I_{f, yy}, \, I_{f, zz}  \right\}$, depends on the cylinders inner and outer radii, $r$ and $R$, its height $h$ and the material density $\rho$:
\begin{equation}
\begin{split}
I_{f, xx} = I_{f, yy} &= \frac{1}{12}\pi \rho h \left(3\left(R^4 - r^4\right) + h^2\left(R^2 - r^2\right)\right) \\
I_{f, zz} &= \frac{1}{2}\pi \rho h \left(R^4 - r^4\right)
\end{split}
\end{equation}
Notice that in the Elroy's Beanie model, there is a single body that models the complete \gls{ocs}. The inertia introduced in the Elroy's Beanie model has to be split between the two flywheels: $I_{f, zz} = I_f/\left(2\cos(\alpha)\right)$. 
The parameters $R$ and $h$ can be set to have a compact \gls{ocs} and $\rho$ depends on the chosen material, that is stainless steel in our case. The inner radius $r$ can be adjusted to obtain the desired inertia. Spokes with negligible mass connect the wheel to the motor shaft. All the parameters are reported in Table \ref{tab:dim_fw}, together with the selected inertia and mass of a single flywheel.
\begin{figure}[t!]
	\centering
	\includegraphics[width=7cm,height=8cm,keepaspectratio]{figures/flywheel_opaque.png}
	\caption{\small The final design of the flywheel, shown together with its inertia principal axes. Here, $h$ is the wheel thickness, $r$ is the inner radius of the wheel and $R$ is the outer one.}
	\label{fig:flywheel}
\end{figure}
\begin{table}[t] 
	\caption{Sizes and dynamic parameters of a single flywheel}
	\label{tab:dim_fw}
	\newcolumntype{C}{>{\centering\arraybackslash}X}
	\begin{tabularx}{\textwidth}{CCC}
		\toprule
		\textbf{Parameter} & \textbf{Value} & \textbf{Unit}\\
		\midrule
		$r$ & $2.20\cdot 10^{-2}$ & $\mathrm{m}$ \\
		$R$ & $3.00\cdot 10^{-2}$ & $\mathrm{m}$ \\
		$h$   & $1.02\cdot 10^{-2}$ & $\mathrm{m}$ \\
		$\rho$   & $7.86 \cdot 10^{+3}$ & $\mathrm{kg/m^3}$ \\
		$m$   & $1.02\cdot 10^{-1}$ & $\mathrm{kg}$ \\
		$I_{xx}, I_{yy}$   & $3.64 \cdot 10^{-5}$ & $\mathrm{kg \cdot m^2}$ \\
		$I_{zz}$   & $7.11 \cdot 10^{-5}$ & $ \mathrm{kg \cdot m^2}$\\
		\bottomrule	\end{tabularx}
\end{table}
\unskip


\subsection{Flywheels Control Law}
\label{subsec:control_law}
To derive a control law based on the robot base orientation, we make use of \eqref{eq:cons_ang_mom}, expressing all the contributions to the time derivative of total angular momentum with the respect to the base reference frame:
\MF{\begin{equation}
\tensor[_b]{\bm{I}}{_f} \, \tensor[_b]{\dot{\bm{\omega}}}{_f} + \tensor[_b]{\bm{I}}{_r} \tensor[_b]{\dot{\bm{\omega}}}{_r} + \tensor[_b]{\bm{\omega}}{_r} \times \left( \tensor[_b]{\bm{I}}{_r} \tensor[_b]{\bm{\omega}}{_r}\right) = 0
\end{equation}}
From this expression, the moment on the base caused by the acceleration of the flywheels \MF{is defined}, that can be used as a feedback torque $\bm{\tau}_{fb}$:
\MF{\begin{equation}
\begin{split}
\bm{\tau}_{fb} &= \bm{I}_f \dot{\bm{\omega}}_f \\
&= - \tensor[_b]{\bm{I}}{_r} \dot{\bm{\omega}}_b - \tensor[_b]{\bm{\omega}}{_r} \times \left( \tensor[_b]{\bm{I}}{_r} \tensor[_b]{\bm{\omega}}{_r}\right)
\end{split}
\end{equation}}
\MF{Proportional and derivative} action $\bm{K}_p \bm{e} + \bm{K}_d \dot{\bm{e}_r}$ \MF{is used}, where $\bm{K}_p$ and $\bm{K}_d$ are diagonal and positive-definite gain matrices for the error in attitude and angular velocity.
The orientation error $\bm{e} \in SO(3)$ needs the algebra of the special rotational group to be computed. To avoid singular configurations, orientation \MF{are represented} with quaternions.
The derivative error can be computed using $\dot{\bm{e}} = \tensor[_b]{\bm{\omega}}{_r^{des}} - \tensor[_b]{\bm{\omega}}{_r}$, in which $\tensor[_b]{\bm{\omega}}{_r^{des}}$ and $\tensor[_b]{\bm{\omega}}{_r}$ are, respectively, the desired and actual angular velocity of the base:
\MF{\begin{equation}
\bm{\tau}_{fb} = - \tensor[_b]{\bm{I}}{_r} \left(\bm{K}_p \bm{e} + \bm{K}_d \dot{\bm{e}}\right) - \tensor[_b]{\bm{\omega}}{_r} \times \left( \tensor[_b]{\bm{I}}{_r} \tensor[_b]{\bm{\omega}}{_r}\right).
\end{equation}}
Projecting the moment $\bm{\tau}_{fb}$ onto the flywheel axes with $\bm{C}^T$, the control action $\bm{u}$ \MF{yields}
\begin{equation}
\label{eq:ctrl_law}
\bm{u} = \bm{C}^T \bm{\tau}_{fb}.
\end{equation}

\section{Results of Simulations}
\label{sec:simulations}
To validate our \gls{ocs}, three simulations on different scenarios \MF{are reported}. \MF{The authors} want to test the capability of the proposed approach to: 
reject a disturbance when the robot is in the flight phase of a jump, damp trunk oscillations after the touch-down, 
and work in parallel with the joints of the legs to achieve a highly dynamic motion. 
All the simulations are performed using \MF{ROS \cite{quigley2009ros} together with Gazebo \cite{koenig2004design}. Physics related parameters are reported in Table \ref{tab:pys_param}.} \MF{References for the joints of the legs are computed off-line using Crocoddyl, an optimal control library for robots based on \gls{ddp} algorithms. It uses Pinocchio for fast computation of robots dynamics and their analytical derivatives. References $\bm{q}_{ref}$, $\dot{\bm{q}}_{ref}$ and $\bm{\tau}_{ref}$ for joint positions, velocities and torques are then executed on-line with a proportional-derivative joint controller:
\begin{equation}
\bm{\tau}_j = \bm{K}_{p,\, j} (\bm{q}_{ref} - \bm{q}) + \bm{K}_{d,\, j} (\dot{\bm{q}}_{ref} - \dot{\bm{q}}) + \bm{\tau}_{ref}
\end{equation}
} The \gls{ocs} is commanded to track base orientation references using the control law introduced in Subsection \ref{subsec:control_law} \MF{coded in Python}.\footnote{The video with all the simulations is available at web link \url{https://www.dropbox.com/scl/fo/wevvl0zvfp8gofie6x7rw/h?dl=0&rlkey=pap76cr813a0skrvrxl7qgrb9}.}

\begin{table}[t!] 
	\caption{\MF{Physics related parameters used for simulate the robot dynamics in Gazebo}}
	\label{tab:pys_param}
	\newcolumntype{C}{>{\centering\arraybackslash}X}
	\begin{tabularx}{\textwidth}{CC}
		\toprule
		\textbf{Parameter} & \textbf{Value} \\
		\midrule
		Step size & $0.001 \ \mathrm{s}$\\
		Real time update rate & $250$ \\
		Physics engine & Open Dynamics Engine (ODE) \\
		Solver & Quick (Projected Gauss-Seidel method)\\
		Iterations & $50$\\
		Successive Over Relaxation parameter & $1.3$\\
		Rescaling Moment of Inertia  & no \\
		Friction model & Pyramid \\		
		\bottomrule	\end{tabularx}
\end{table}
\begin{figure}[t]
	\centering
	\includegraphics[width=.7\linewidth]{figures/drawing.png}
	\caption{\small First Test: simulation results showing the $\mathrm{CoM}_x$ and pitch trajectory vs. time plots. A disturbance moment $\bm{\tau}_{dist}$ on the trunk can be compensated only if the \gls{ocs} is enabled. If it is disabled, the robot is unable to restore a safe configuration after the touch-down and eventually falls. The light blue area represents the interval of time in which the disturbance is applied.}
	\label{fig:fw_jump}
\end{figure}



\begin{figure}[t!]
	\centering
	\includegraphics[width=.7\linewidth]{figures/fall_plot.eps}
	\caption{\small Second Test: simulation results showing the $\mathrm{CoM}_x$ and pitch trajectory vs. time plots. The \gls{ocs} drives the robot orientation during a fall to be horizontal. This allows to damp for damping the base oscillations after the touch-down (vertical dashed line), even without implementing a landing strategy}
	\label{fig:fall_plot}
\end{figure}
\begin{figure}[h!]
	\centering
	\includegraphics[width=\linewidth]{figures/backflip.png}
	\caption{\small \MF{Third Test: sequence of snapshots of Solo12 performing a back-flip in Gazebo environment. The \gls{ocs} alleviates the effort requested to the leg joints, that in this case can be used to accomplish only the vertical motion. The red, green and blue lines represent the axes of the inertial (world) reference frame.}}
	\label{fig:backflip}
\end{figure}

%In a second test, we demonstrate the versatility use the presented \gls{ocs} to dump the base oscillations generated at the landing. 
%% , even though we designed it to control the orientation during the flight phase.
%To demonstrate this feature, we use the same joint trajectory to perform two simulations: 
%in the first, we control the flywheels to track an orientation parallel to the ground, while in the other they are not actuated.
%The joint trajectory realizes a jump with a height of $0.4 \ \mathrm{m}$, a forward distance of $0.8 \ \mathrm{m}$, and a flight phase of $0.5 \ \mathrm{s}$. \MF{why you detail here the jump and not before? is the same jump?}
%The results point out the possibility to use this device even when the angular momentum is not conserved (i.e. when contacts are present).
%this is the main test! 
The necessity of having an \gls{ocs} is revealed with the first test: disturbance that occurs when the robot has no contact with the ground. 
During the flight phase of a forward jump, $0.1~\mathrm{s}$ after the lift-off, an external disturbance moment is applied to the robot base, deflecting the robot orientation: this disturbance is set to $\bm{\tau}_{dist} = \left[\begin{array}{ccc}
0.2 & 0.8 & 0.0
\end{array}
\right]^T \ \mathrm{N \cdot m}$ and applied for $0.05 \ \mathrm{s}$. 
If the flywheels are not used, Solo12 falls after the touch-down. Instead, 
using the flywheels %pairing the legs joint PD controller with \ref{eq:ctrl_law},
it is possible to drive the robot to a safe configuration after the landing (Fig. \ref{fig:fw_jump}), without need to implement of a specific landing strategy, as the one in \cite{jeon2021real}.


\MF{The second test demonstrates} the ability of the \gls{ocs} to reorient the base.
\MF{The robot is falling} from a height of $1.0 \ \mathrm{m}$ with an initial pitch orientation of $30^\circ$ and zero base angular velocity.
\MF{If the flywheels are not actuated}, the robot touches the ground with the same initial orientation and the trunk oscillates. If the \gls{ocs} is enabled, it drives the robot base to be horizontal when it is still in the air and the oscillations after the touch-down are drastically reduced, both in the pitch angle and forward direction (Fig. \ref{fig:fall_plot}).

\MF{Finally, the ability of the flywheels to relieve the effort on the leg joints to achieve a highly dynamic movement is shown with a back-flip} (Fig. \ref{fig:backflip}). 
For this, we target a space application carrying out a simulation with \MF{lunar gravity acceleration} ($1.62 \ \mathrm{m/s^2}$).
In this way, it is possible to obtain high jumps with a long flight phase, without having to select more powerful actuators.  
The leg joint trajectory computed off-line describes a purely vertical jump of $1 \ \mathrm{m}$, having a flight phase that lasts $2 \ \mathrm{s}$.
Right after the lift-off, the flywheels start the reorientation task of performing a back-flip, that is a spin of $360^\circ$ on the pitch.
For this maneuver, the value of the incident angle $\alpha$ is set to $0^\circ$ since no roll rotation is required.
% and it is preferred to use all the contributions of the \gls{ocs} on the pitch.
Our hardware design allows the manual change of this value before performing the task.
This simulation demonstrates that the \gls{ocs} alleviate the effort to be applied on the legs: indeed, that it would not have been possible to do a back-flip without the flywheels because the legs are used only to achieve the linear motion. 

\section{Conclusions}
\label{sec:conclusions}

\MF{This work presented} the design of a novel \gls{ocs}, composed of two flywheels, that enables to control the trunk of a legged robot platform, increasing the accuracy of aerial maneuvers during the under-actuated phases (i.e. flight phase) as well as enhancing stability when in contact by damping oscillations. The novelty of the design, that involves the flywheels to be attached with incident rotational axes on the trunk, allows to control the orientation in both the roll and pitch directions while keeping the device compact. Their effect is optimized considering the inertial property of the mechanical structure. Several simulations are reported with the quadruped Solo12 that demonstrate the effectiveness of the proposed approach to: reject disturbances during the flight phase, stabilize the platform after the touch-down even in absence of a specific landing strategy and achieve a fast reorientation maneuver (a back-flip) in a reduced gravity environment. 

\MF{Possible applications of the presented \gls{ocs} include but are not limited to efficiently adjust the posture of quadruped robots walking or jumping on uneven terrains. As proved in the third simulation (back-flip), our approach improves the capabilities of quadrupeds in space application enabling fast locomotion by means of leaps, ensuring a reactive control action on the robot angular momentum. Furthermore, the method presented in Section 3 for designing the OCS does not depend on the specific platform, thus it can be replicated for reorienting mechanical structures with different morphology, e.g, monopods or bipeds. A construction worker's backpack can contain two flywheels with incident rotation axes: in the event of a fall from scaffolding, they can be used to reorient the human body to avoid impact of the head with the ground with the same controller proposed in this work.}

In future works, \MF{the authors} plan to demonstrate our concept performing experiment with the real platform. The control strategy for defining the base desired angular velocity can be improved using \gls{nmpc}, that takes into consideration the future samples of the orientation reference.
\MF{This feature is expected to allow} the stabilization of the yaw to a desired value, that if it is not locally controllable, enhancing the non-holonomy property of the angular momentum, i.e. doing a preliminary roll and pitch maneuver. 
A control strategy that may lead to the same result is dynamic feedback linearization, widely used for flight with quadricopters.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\vspace{6pt} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% optional
%\supplementary{The following supporting information can be downloaded at:  \linksupplementary{s1}, Figure S1: title; Table S1: title; Video S1: title.}

% Only for the journal Methods and Protocols:
% If you wish to submit a video article, please do so with any other supplementary material.
% \supplementary{The following supporting information can be downloaded at: \linksupplementary{s1}, Figure S1: title; Table S1: title; Video S1: title. A supporting video article is available at doi: link.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
\authorcontributions{Conceptualization, F.R. and M.F.; software, F.R., A.C. and M.F.; validation, F.R., A.C. and M.F.; formal analysis, F.R., A.C. and M.F.; investigation, F.R. and A.C.; resources, C.S.; data curation, F.R., A.C. and M.F.; writing---original draft preparation, F.R.; writing---review and editing, F.R., A.C., A.D.P., C.S. and M.F.; visualization, F.R. and A.C.; supervision, A.D.P. and M.F; project administration, F.R. and M.F.; funding acquisition, M.F., C.S. All authors have read and agreed to the published version of the manuscript.}
%\authorcontributions{For research articles with several authors, a short paragraph specifying their individual contributions must be provided. The following statements should be used ``Conceptualization, X.X. and Y.Y.; methodology, X.X.; software, X.X.; validation, X.X., Y.Y. and Z.Z.; formal analysis, X.X.; investigation, X.X.; resources, X.X.; data curation, X.X.; writing---original draft preparation, X.X.; writing---review and editing, X.X.; visualization, X.X.; supervision, X.X.; project administration, X.X.; funding acquisition, Y.Y. All authors have read and agreed to the published version of the manuscript.'', please turn to the  \href{http://img.mdpi.org/data/contributor-role-instruction.pdf}{CRediT taxonomy} for the term explanation. Authorship must be limited to those who have contributed substantially to the work~reported.}

\funding{The publication was created with the co-financing of the European Union FSE-REACT-EU, PON Research and Innovation 2014-2020 DM1062 / 2021.}

\institutionalreview{Not applicable.}

\informedconsent{Not applicable.}

\dataavailability{Not applicable.} 

\acknowledgments{All the authors want to thank Dr. Roy Featherstone for interesting tips that started this work. }

\conflictsofinterest{The authors declare no conflict of interest.} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Optional
%\sampleavailability{Samples of the compounds ... are available from the authors.}

%% Only for journal Encyclopedia
%\entrylink{The Link to this entry published on the encyclopedia platform.}
\abbreviations{Abbreviations}{
The following abbreviations are used in this manuscript:\\

\noindent 
\begin{tabular}{@{}ll}
DoF & Degree of Freedom\\
CoM & Center Of Mass\\
OCS & Orientation Control System\\
CMG & Control Moment Gyroscope\\
\MF{DDP} & \MF{Differential Dynamic Programming}\\
NMPC & Nonlinear Model Predictive Control
\end{tabular}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Optional
%\appendixtitles{no} % Leave argument "no" if all appendix headings stay EMPTY (then no dot is printed after "Appendix A"). If the appendix sections contain a heading then change the argument to "yes".
%\appendixstart
%\appendix
%\section[\appendixname~\thesection]{}
%\subsection[\appendixname~\thesubsection]{}
%The appendix is an optional section that can contain details and data supplemental to the main text---for example, explanations of experimental details that would disrupt the flow of the main text but nonetheless remain crucial to understanding and reproducing the research shown; figures of replicates for experiments of which representative data are shown in the main text can be added here if brief, or as Supplementary Data. Mathematical proofs of results not central to the paper can be added as an appendix.

%\begin{table}[H] 
%\caption{This is a table caption.\label{tab5}}
%\newcolumntype{C}{>{\centering\arraybackslash}X}
%\begin{tabularx}{\textwidth}{CCC}
%\toprule
%\textbf{Title 1}	& \textbf{Title 2}	& \textbf{Title 3}\\
%\midrule
%Entry 1		& Data			& Data\\
%Entry 2		& Data			& Data\\
%\bottomrule
%\end{tabularx}
%\end{table}

%\section[\appendixname~\thesection]{}
%All appendix sections must be cited in the main text. In the appendices, Figures, Tables, etc. should be labeled, starting with ``A''---e.g., Figure A1, Figure A2, etc.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{adjustwidth}{-\extralength}{0cm}
%\printendnotes[custom] % Un-comment to print a list of endnotes

\reftitle{References}

% Please provide either the correct journal abbreviation (e.g. according to the “List of Title Word Abbreviations” http://www.issn.org/services/online-services/access-to-the-ltwa/) or the full name of the journal.
% Citations and References in Supplementary files are permitted provided that they also appear in the reference list here. 

%=====================================
% References, variant A: external bibliography
%=====================================
\bibliography{references/bibliography.bib}

%=====================================
% References, variant B: internal bibliography
%=====================================
%\begin{thebibliography}{999}
% Reference 1
%\bibitem[Author1(year)]{ref-journal}
%Author~1, T. The title of the cited article. {\em Journal Abbreviation} {\bf 2008}, {\em 10}, 142--149.
% Reference 2
%\bibitem[Author2(year)]{ref-book1}
%Author~2, L. The title of the cited contribution. In {\em The Book Title}; Editor 1, F., Editor 2, A., Eds.; Publishing House: City, Country, 2007; pp. 32--58.
% Reference 3
%\bibitem[Author3(year)]{ref-book2}
%Author 1, A.; Author 2, B. \textit{Book Title}, 3rd ed.; Publisher: Publisher Location, Country, 2008; pp. 154--196.
% Reference 4
%\bibitem[Author4(year)]{ref-unpublish}
%Author 1, A.B.; Author 2, C. Title of Unpublished Work. \textit{Abbreviated Journal Name} year, \textit{phrase indicating stage of publication (submitted; accepted; in press)}.
% Reference 5
%\bibitem[Author5(year)]{ref-communication}
%Author 1, A.B. (University, City, State, Country); Author 2, C. (Institute, City, State, Country). Personal communication, 2012.
% Reference 6
%\bibitem[Author6(year)]{ref-proceeding}
%Author 1, A.B.; Author 2, C.D.; Author 3, E.F. Title of presentation. In Proceedings of the Name of the Conference, Location of Conference, Country, Date of Conference (Day Month Year); Abstract Number (optional), Pagination (optional).
% Reference 7
%\bibitem[Author7(year)]{ref-thesis}
%Author 1, A.B. Title of Thesis. Level of Thesis, Degree-Granting University, Location of University, Date of Completion.
% Reference 8
%\bibitem[Author8(year)]{ref-url}
%Title of Site. Available online: URL (accessed on Day Month Year).
%\end{thebibliography}

% If authors have biography, please use the format below
%\section*{Short Biography of Authors}
%\bio
%{\raisebox{-0.35cm}{\includegraphics[width=3.5cm,height=5.3cm,clip,keepaspectratio]{Definitions/author1.pdf}}}
%{\textbf{Firstname Lastname} Biography of first author}
%
%\bio
%{\raisebox{-0.35cm}{\includegraphics[width=3.5cm,height=5.3cm,clip,keepaspectratio]{Definitions/author2.jpg}}}
%{\textbf{Firstname Lastname} Biography of second author}

% For the MDPI journals use author-date citation, please follow the formatting guidelines on http://www.mdpi.com/authors/references
% To cite two works by the same author: \citeauthor{ref-journal-1a} (\citeyear{ref-journal-1a}, \citeyear{ref-journal-1b}). This produces: Whittaker (1967, 1975)
% To cite two works by the same author with specific pages: \citeauthor{ref-journal-3a} (\citeyear{ref-journal-3a}, p. 328; \citeyear{ref-journal-3b}, p.475). This produces: Wong (1999, p. 328; 2000, p. 475)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% for journal Sci
%\reviewreports{\\
%Reviewer 1 comments and authors’ response\\
%Reviewer 2 comments and authors’ response\\
%Reviewer 3 comments and authors’ response
%}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{adjustwidth}
\end{document}

